<mujoco model="CanSatSolidChute">
  <compiler angle="degree" coordinate="local" inertiafromgeom="true"/>
  <option integrator="RK4" gravity="0 0 -9.81"/>

  <visual>
    <map znear="0.001"/>
    <quality shadowsize="4096"/>
  </visual>
  
  <asset>
    <texture type="skybox" builtin="gradient" rgb1="0.3 0.5 0.8" rgb2="0.1 0.2 0.4" width="512" height="3072"/>
    <material name="cansat_frame" shininess="0.7" specular="0.8" rgba="0.8 0.2 0.2 1"/>
    <material name="parachute_fabric" shininess="0.1" specular="0.1" rgba="0.95 0.95 0.95 0.9"/>
  </asset>

  <worldbody>
    <geom name="ground" type="plane" size="2000 2000 0.1" rgba="0.2 0.3 0.2 1"/>
    <light name="sun" directional="true" pos="0 -1 2" dir="0 1 -1" castshadow="true"/>

    <body name="cansat_body" pos="0 0 1000">
      <freejoint name="world_joint"/>
      
      <!-- CanSat "Cage" Frame -->
      <geom material="cansat_frame" type="capsule" fromto="0.075 0 -0.2 0.075 0 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="-0.075 0 -0.2 -0.075 0 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0 0.075 -0.2 0 0.075 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0 -0.075 -0.2 0 -0.075 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0.075 0 0.2 0.053 0.053 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0.053 0.053 0.2 0 0.075 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0 0.075 0.2 -0.053 0.053 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="-0.053 0.053 0.2 -0.075 0 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="-0.075 0 0.2 -0.053 -0.053 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="-0.053 -0.053 0.2 0 -0.075 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0 -0.075 0.2 0.053 -0.053 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0.053 -0.053 0.2 0.075 0 0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0.075 0 -0.2 0.053 0.053 -0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0.053 0.053 -0.2 0 0.075 -0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0 0.075 -0.2 -0.053 0.053 -0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="-0.053 0.053 -0.2 -0.075 0 -0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="-0.075 0 -0.2 -0.053 -0.053 -0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="-0.053 -0.053 -0.2 0 -0.075 -0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0 -0.075 -0.2 0.053 -0.053 -0.2" size="0.01"/><geom material="cansat_frame" type="capsule" fromto="0.053 -0.053 -0.2 0.075 0 -0.2" size="0.01"/>
      
      <!-- Reaction Wheels -->
      <body name="rw_roll" pos="0 0 -0.1"><joint name="joint_x_roll" type="hinge" axis="1 0 0"/><geom type="cylinder" size="0.05 0.01" rgba="1 0.2 0.2 1"/><geom type="box" size="0.05 0.005 0.005" pos="0.025 0 0" rgba="1 1 1 1"/></body>
      <body name="rw_pitch" pos="0 0 0"><joint name="joint_y_pitch" type="hinge" axis="0 1 0"/><geom type="cylinder" size="0.05 0.01" rgba="0.2 1 0.2 1"/><geom type="box" size="0.05 0.005 0.005" pos="0.025 0 0" rgba="1 1 1 1"/></body>
      <body name="rw_yaw" pos="0 0 0.1"><joint name="joint_z_yaw" type="hinge" axis="0 0 1"/><geom type="cylinder" size="0.05 0.01" rgba="0.2 0.2 1 1"/><geom type="box" size="0.05 0.005 0.005" pos="0.025 0 0" rgba="1 1 1 1"/></body>

      <!-- Solid Parachute model (no spill hole) -->
      <geom name="panel1" material="parachute_fabric" type="capsule" fromto="0.25 0 0.6 0.125 0.216 0.6" size="0.1" contype="0" conaffinity="0" mass="0"/><geom name="panel2" material="parachute_fabric" type="capsule" fromto="0.125 0.216 0.6 -0.125 0.216 0.6" size="0.1" contype="0" conaffinity="0" mass="0"/><geom name="panel3" material="parachute_fabric" type="capsule" fromto="-0.125 0.216 0.6 -0.25 0 0.6" size="0.1" contype="0" conaffinity="0" mass="0"/><geom name="panel4" material="parachute_fabric" type="capsule" fromto="-0.25 0 0.6 -0.125 -0.216 0.6" size="0.1" contype="0" conaffinity="0" mass="0"/><geom name="panel5" material="parachute_fabric" type="capsule" fromto="-0.125 -0.216 0.6 0.125 -0.216 0.6" size="0.1" contype="0" conaffinity="0" mass="0"/><geom name="panel6" material="parachute_fabric" type="capsule" fromto="0.125 -0.216 0.6 0.25 0 0.6" size="0.1" contype="0" conaffinity="0" mass="0"/>
      <!-- FIX: Added a central cylinder to plug the spill hole -->
      <geom name="chute_center_plug" material="parachute_fabric" type="cylinder" pos="0 0 0.6" size="0.13 0.001" contype="0" conaffinity="0" mass="0"/>
      
      <!-- Riser lines -->
      <geom name="riser1" material="parachute_fabric" type="capsule" fromto="0 0 0.2 0.25 0 0.6" size="0.004"/><geom name="riser2" material="parachute_fabric" type="capsule" fromto="0 0 0.2 -0.25 0 0.6" size="0.004"/><geom name="riser3" material="parachute_fabric" type="capsule" fromto="0 0 0.2 -0.125 0.216 0.6" size="0.004"/><geom name="riser4" material="parachute_fabric" type="capsule" fromto="0 0 0.2 0.125 -0.216 0.6" size="0.004"/>
    </body>
  </worldbody>
  
  <actuator>
    <motor name="motor_x_roll"  joint="joint_x_roll"  gear="1" ctrllimited="true" ctrlrange="-1.0 1.0"/>
    <motor name="motor_y_pitch" joint="joint_y_pitch" gear="1" ctrllimited="true" ctrlrange="-1.0 1.0"/>
    <motor name="motor_z_yaw"   joint="joint_z_yaw"   gear="1" ctrllimited="true" ctrlrange="-1.0 1.0"/>
  </actuator>
</mujoco>